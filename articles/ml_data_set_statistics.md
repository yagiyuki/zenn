---
title: "統計学で機械学習モデルを評価する 〜母比率の区間推定〜"
emoji: "👻"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["統計検定", "統計学", "Python", "機械学習"]
published: false
---

この記事では、母比率の区間推定を用いた機械学習モデルを評価する方法を書きます。
統計学を使うことで機械学習モデルの評価をより精密に実施することを目指します。

:::message
本記事で記載した内容は、私的なアイディアをまとめたものになります。
機械学習モデルの評価方法として確立したものではない点をご認識ください。
:::

## 評価データはどのくらいあるといい?

教師あり機械学習のモデル評価の代表的な手法として「ホールドアウト法」や「クロスバリデーション法」があります。
ここでいう評価データとは、以下を指します。

* ホールドアウト法でいうところの「検証データ」および「テストデータ」
* クロスバリデーション法でいうところの「テストデータ」

いずれも評価の手法としては確立されていますが、評価データとしてどのくらいの数が必要かという話はあまりないです。
この評価データの数を統計的に見積もってみます。

## 学習データはどのくらいあるといい?

これは端的にいえば、必要な精度が出るまでです。
どんなデータを使うか、どんなアルゴリズムを使うかによって回答が違ってきます。
実際にやってみないとわからないというのが回答になるかと思います。

:::message
評価データがちゃんと用意できていれば、評価データに対して期待した精度が出るだけのデータを用意すればよいということになるはず！
:::

## 最低限必要な知識

母比率の区間推定でテストデータの数を見積もるうえで、必要な知識をざっくり整理しておきます。
すでに母比率の区間推定やそれに関する知識について知っている人は読み飛ばしてもらってOKです。
なお、ここの知識は[統計Web](https://bellcurve.jp/statistics/course/#step1)を参考に書いています。

### 母集団
本来知りたいと思っている集団全体のこと。

### 標本
一方、母集団の情報を推測するために選ばれた一部の集団のことを「標本」という。

### 推測統計学
母集団から抽出された標本を用いて、母集団の性質を推測すること。

母集団の性質の例は以下の通り

* 母平均: 例) 日本人の身長の平均
* 母比率: 例) 日本人のうち身長が175cm以上の人の比率
* 母分散: 例) 日本人の身長の分散
日本人全体の身長を全数調査することは難しい。
(国が世論調査でもしない限り現実的でない。)

機械学習のモデル性能を評価する場合は、母比率の推定となる。

### サンプルサイズ

抽出した標本のデータ数のことをサンプルサイズという。
類似した言葉で、サンプル数というものがあるが、これは、標本調査の回数を指す。

例: 日本に住む女性から100人を抽出してアンケートを行うという調査を5回繰り返したとき、サンプルサイズは「100」、サンプル数は「5」。

という調査を5回繰り返すとします。

### 信頼区間

区間推定において、母数がその内に含まれると推定された区間のことをいう。
一般的に使われる指標は以下の3つ

* 90%の信頼区間
* 95%の信頼区間
* 99%の信頼区間

95%信頼区間とは、標本抽出を100回繰り返したき、95回くらいは信頼区間中に母数が含まれるということを示す。
ゆえに、95%の母比率の区間推定の結果が、78.7%〜81.3%であったととき、以下の解釈となる。

:::message
標本抽出を100回繰り返したき、95回くらいは、標本比率が「78.7%〜 81.3%」に収まる。
逆に言うと、5回くらいは、標本比率が「78.7%〜 81.3%」に収まらない結果となる。
信頼区間の幅は、81.3 - 78.7 = 2.6%となる。
:::


### 母比率の区間推定

抽出した標本から母比率を推定する方法として、母比率の区間推定という手法がある。
抽出した標本の比率がXであったとき、母比率はどのくらいの大きさであるかを区間で推定する手法となる。

区間推定に必要な情報は以下の3つです。

* 標本比率
* サンプルサイズ
* 信頼区間




## 母比率の区間推定を使って評価データの数を見積もる

実際に統計学の母比率の区間推定を使って評価データの数を見積もってみます。



## 演習

自分で手を動かして計算できるように、演習形式にしてみました。 

### 演習1

:::details 答え
表示したい内容
:::

### 演習2


### 演習3


## まとめ

